package service.vulnerabilities_aggregation.Preprocessing;

import entities.programEntities.Email;
import entities.programEntities.miningEntities.PreprocessingEntity;

import java.util.ArrayList;

public class EmailsPreprocessing extends Preprocessing {

    ArrayList<Email> emails;
    ArrayList<PreprocessingEntity> preprocessingEntities = new ArrayList<PreprocessingEntity>();

    public EmailsPreprocessing(ArrayList<Email> receivedEmails){
        this.emails = receivedEmails;
    }

    public void createEmailEntitiesForPreprocessing(){
        for(Email eachEmail : emails){
            PreprocessingEntity emailPreprocessing = new PreprocessingEntity();
            if(eachEmail.getSubject().contains("[FD]")){        //from full-disclosure

            }
            if(eachEmail.getSubject().contains("[gentoo-announce]")){ // from gentoo security

                String shortResult = eachEmail.getContent().substring(eachEmail.getContent().indexOf("Synopsis")+19,
                        eachEmail.getContent().indexOf("Background")-2);
                String longResult = eachEmail.getContent().substring(eachEmail.getContent().indexOf("Description")+25,
                        eachEmail.getContent().indexOf("Impact")-2);

                emailPreprocessing.setOriginalMessage(eachEmail.getContent());
                emailPreprocessing.setShortDescription(shortResult);
                emailPreprocessing.setLongDescription(longResult);
                emailPreprocessing.setSource("Gentoo Security");
            }
            if(eachEmail.getSubject().contains("Security-announce") || eachEmail.getSubject().contains("VMware")){ // from VMware

            }
        }
    }

}