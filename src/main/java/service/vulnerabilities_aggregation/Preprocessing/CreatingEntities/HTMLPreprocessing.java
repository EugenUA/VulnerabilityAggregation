package service.vulnerabilities_aggregation.Preprocessing.CreatingEntities;


import entities.programEntities.HTMLAlert;
import entities.programEntities.miningEntities.PreprocessingEntity;

import java.util.ArrayList;

public class HTMLPreprocessing{

    ArrayList<HTMLAlert> htmlAlerts;
    ArrayList<PreprocessingEntity> preprocessingEntities = new ArrayList<PreprocessingEntity>();

    public HTMLPreprocessing(ArrayList<HTMLAlert> alerts){
        this.htmlAlerts = alerts;
    }

    public ArrayList<PreprocessingEntity> getPreprocessingEntities() {
        return preprocessingEntities;
    }

    public void createHTMLPreprocessingEntities(){
        for(HTMLAlert alert : htmlAlerts){

            PreprocessingEntity preprocessingEntity = new PreprocessingEntity();

            if(alert.getOrigin().equals("FreeBSD")){
                preprocessingEntity.setSource("FreeBSD");
                preprocessingEntity.setOriginalMessage(alert.getDescription());
                preprocessingEntity.setShortDescription(alert.getTitle());
                preprocessingEntity.setLongDescription(alert.getDescription());

                preprocessingEntities.add(preprocessingEntity);
            }

            if(alert.getOrigin().equals("Secunia Research")){
                preprocessingEntity.setSource("Secunia Research");
                preprocessingEntity.setOriginalMessage(alert.getDescription());
                preprocessingEntity.setShortDescription(alert.getTitle());
                preprocessingEntity.setLongDescription(alert.getDescription());

                preprocessingEntities.add(preprocessingEntity);
            }
        }
    }
}
