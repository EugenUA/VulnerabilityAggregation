package dao.db;

import dao.DAOException;
import org.apache.log4j.LogManager;
import org.apache.log4j.Logger;

import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;

/**
 * Created by Eugen on 31.08.2017.
 */
public class SQLiteCreateDescriptionTable {

    private static final Logger logger = LogManager.getLogger(SQLiteCreateDescriptionTable.class);
    private Connection con = null;
    private Statement stmt = null;

    public SQLiteCreateDescriptionTable(Connection con){
        this.con = con;
    }

    public void createDescriptionTable() throws DAOException{
        try{
            stmt = con.createStatement();
            String sql = "CREATE TABLE IF NOT EXISTS Description" +
                        "(id INTEGER PRIMARY KEY AUTOINCREMENT, " +
                        " vulnerability_id INTEGER, " +
                        " release_date TEXT, " +
                        " severity_level TEXT, " +
                        " technical_description TEXT, " +
                        " author TEXT, " +
                        " solution TEXT, " +
                        " FOREIGN KEY(vulnerability_id) REFERENCES Vulnerability(id));";
            stmt.executeUpdate(sql);
            stmt.close();
        } catch(SQLException e){
            logger.debug(e.getMessage());
            throw new DAOException(e.getMessage());
        }
    }
}
