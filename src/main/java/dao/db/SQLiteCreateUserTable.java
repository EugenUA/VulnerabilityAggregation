package dao.db;

import dao.DAOException;
import org.apache.log4j.Logger;

import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;

import org.apache.log4j.LogManager;

/**
 * Created by Eugen on 23.08.2017.
 */
public class SQLiteCreateUserTable {

    private static final Logger logger = LogManager.getLogger(SQLiteCreateUserTable.class);
    Connection con = null;
    Statement stmt = null;

    public SQLiteCreateUserTable(Connection con){
        this.con = con;
    }

    public void createUserTable() throws DAOException{
        logger.info("Creating of User Table");
        try {
            stmt = con.createStatement();
            String sql = "CREATE TABLE IF NOT EXISTS User" +
                        "(id INTEGER PRIMARY KEY AUTOINCREMENT," +
                        " name TEXT NOT NULL," +
                        " password TEXT NOT NULL,"+
                        " email TEXT NOT NULL)";
            stmt.executeUpdate(sql);
            stmt.close();
            logger.info("User table successfully created");
        } catch(SQLException e){
            logger.debug(e.getMessage());
            throw new DAOException(e.getMessage());
        }

    }
}
